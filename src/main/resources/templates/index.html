<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" id="html">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Comunidad Bem&eacute;dica | Bem&eacute;dica</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="all,follow">
    <!-- Bootstrap CSS-->
    <link rel="stylesheet" href="vendor/bootstrap/css/bootstrap.min.css">
    <!-- Font Awesome CSS-->
    <link rel="stylesheet" href="vendor/font-awesome/css/font-awesome.min.css">
    <!-- Google fonts - Roboto-->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,700">
    <!-- Bootstrap Select-->
    <link rel="stylesheet" href="vendor/bootstrap-select/css/bootstrap-select.min.css">
    <!-- owl carousel-->
    <link rel="stylesheet" href="vendor/owl.carousel/assets/owl.carousel.css">
    <link rel="stylesheet" href="vendor/owl.carousel/assets/owl.theme.default.css">
    <!-- theme stylesheet-->
    <link rel="stylesheet" href="css/style.default.css" id="theme-stylesheet">
    <!-- Custom stylesheet - for your changes-->
    <link rel="stylesheet" href="css/custom.css">
    <!-- Favicon and apple touch icons-->
    <link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" type="text/css" href="css/slick/slick.css">
    <link rel="stylesheet" type="text/css" href="css/slick/slick-theme.css">
    <link rel="stylesheet" type="text/css" href="css/slidedoc.css">
    <!-- Tweaks for older IEs-->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script><![endif]-->
        
    <!-- Calendario -->
    <link rel="stylesheet" href="plugins/fullcalendar/main.min.css">
  	<link rel="stylesheet" href="plugins/fullcalendar-daygrid/main.min.css">
  	<link rel="stylesheet" href="plugins/fullcalendar-timegrid/main.min.css">
  	<link rel="stylesheet" href="plugins/fullcalendar-bootstrap/main.min.css">
    <!-- Calendario -->
</head>
<style>
    .container-calendar {
        background: #ffffff;
        padding: 15px;
        max-width: 475px;
        margin: 0 auto;
        overflow: auto;
    }
    
    .button-container-calendar button {
        cursor: pointer;
        display: inline-block;
        zoom: 1;
        background: #1eb7bd;
        color: #fff;
        border: 1px solid #1eb7bd;
        border-radius: 4px;
        padding: 5px 10px;
    }
    
    .table-calendar {
        border-collapse: collapse;
        width: 100%;
    }
    
    .table-calendar td,
    .table-calendar th {
        padding: 5px;
        border: 1px solid #e2e2e2;
        text-align: center;
        vertical-align: top;
    }
    
    .date-picker.selected {
        font-weight: bold;
        outline: 1px dashed #00BCD4;
    }
    
    .date-picker.selected span {
        border-bottom: 2px solid currentColor;
    }
    /* sunday */
    
    .date-picker:nth-child(1) {
        color: red;
    }
    /* friday */
    
    .date-picker:nth-child(6) {
        color: green;
    }
    
    #monthAndYear {
        text-align: center;
        margin-top: 0;
    }
    
    .button-container-calendar {
        position: relative;
        margin-bottom: 1em;
        overflow: hidden;
        clear: both;
    }
    
    #previous {
        float: left;
    }
    
    #next {
        float: right;
    }
    
    .footer-container-calendar {
        margin-top: 1em;
        border-top: 1px solid #dadada;
        padding: 10px 0;
    }
    
    .footer-container-calendar select {
        cursor: pointer;
        display: inline-block;
        zoom: 1;
        background: #ffffff;
        color: #585858;
        border: 1px solid #bfc5c5;
        border-radius: 3px;
        padding: 5px 1em;
    }
    
    .card-footer1 {
        padding: 0.75rem 1.25rem;
        background-color: #1eb7bd;
        border-top: 1px solid rgba(0, 0, 0, 0.125);
    }
    
    footer.main-footer1 {
        padding-bottom: 0;
        background: #555;
        color: #fff;
    }
    
    footer.main-footer1 .copyrights {
        padding: 50px 0;
        background: #333;
        color: #ccc;
        margin-top: 50px;
    }
    
    footer.main-footer1 .copyrights a {
        color: #4fbfa8;
    }
    
    footer.main-footer1 .copyrights p {
        color: inherit;
        font-size: 0.8rem;
        margin-bottom: 0;
    }
    .loader {
	  border: 16px solid #f3f3f3; /* Light grey */
	  border-top: 16px solid #3498db; /* Blue */
	  border-radius: 50%;
	  width: 120px;
	  height: 120px;
	  animation: spin 2s linear infinite;
	  margin-left: 44%;
	  margin-top: 5%;
	}

	@keyframes spin {
	  0% { transform: rotate(0deg); }
	  100% { transform: rotate(360deg); }
	}
</style>

<body>
    <div id="all">
        <!-- Top bar-->
        
        

<div class="top-bar">
		
		<!-- Div de Correo confirmado -->
		<div th:if="${param.Confirmed}" class="alert alert-success alert-dismissible" role="alert">
			<a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
  			Gracias por confirmar tu correo. Ya puedes iniciar sesión.
		</div>
		
		<!-- Div para que confirmes tu correo -->
		<div th:if="${param.NoActive}" class="alert alert-warning alert-dismissible">
  			<a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
  			Confirma tu correo para acceder, revisa tu bandeja de entrada. <a href="#" data-toggle="modal" data-target="#ReenviarMail">&nbsp;¿Volver a enviar correo?</a>
		</div>
		
		<!-- Div de que se envio el correo -->
		<div th:if="${param.EmailSended}" class="alert alert-success alert-dismissible">
  			<a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
  			Se ha enviado un correo a tu dirección.
		</div>
		
		<!-- Div para que confirmes tu correo -->
		<div th:if="${param.NoMatchPasswords}" class="alert alert-warning alert-dismissible">
  			<a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
  			No coincidieron las contraseñas.
		</div>
		
		<!-- Div de que ya existe el usuario -->
		<div th:if="${param.NickBusy}" class="alert alert-warning alert-dismissible" role="alert">
			<a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
  			Alguien ya tiene ese nombre de usuario.
		</div>
		
		<!-- Div de que ya existe el correo -->
		<div th:if="${param.EmailBusy}" class="alert alert-warning alert-dismissible" role="alert">
			<a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
  			Ya existe un usuario con ese correo.
		</div>
		
		<!-- Div de que ya existe el correo -->
		<div th:if="${param.EmailNickBusy}" class="alert alert-warning alert-dismissible" role="alert">
			<a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
  			Ya existe un usuario con ese correo y ese nombre.
		</div>
		
		<!-- Div de que no existe el codigo -->
		<div th:if="${param.NoCode}" class="alert alert-warning alert-dismissible" role="alert">
			<a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
  			El codigo ha caducado o se ha roto. <a href="#" data-toggle="modal" data-target="#ReenviarMail">&nbsp;Reenviar Correo</a>
		</div>
		
		<!-- Div de que no existe el correo -->
		<div th:if="${param.NoUser}" class="alert alert-danger alert-dismissible" role="alert">
			<a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
  			No hay ningun usuario registrado con ese correo. 
		</div>
		
		
		<!-- Reenviar Correo Modal -->
		<div class="modal fade" id="ReenviarMail" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  			<div class="modal-dialog" role="document">
    			<div class="modal-content">
      				<div class="modal-header">
        				<h5 style="color: black !important;" class="modal-title" id="exampleModalLabel">Reenviar Correo</h5>
        				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
	          				<span aria-hidden="true">&times;</span>
        				</button>
      				</div>
      			<div class="modal-body">
        			<form action="/Reenviar_Correo" method="GET" th:modelAttribute="User">
          				<div class="form-group">
            				<label for="recipient-name" class="col-form-label">Correo:</label>
            				<input type="email" required class="form-control" name="email">
          				</div>
        			
      			</div>
      			<div class="modal-footer">
        			<button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
        			<button type="submit" class="btn btn-primary">Enviar Correo</button>
      			</div>
      			</form>
    			</div>
  			</div>
		</div>
		<!-- Reenviar Correo Modal -->
		
		
		
		
        <div class="container">
          <div class="row d-flex align-items-center">
            <div class="col-md-6 d-md-block d-none">
              <p><i class="fa fa-phone"></i> +420 777 555 333</p>
            </div>
            <div class="col-md-6">
              <div class="d-flex justify-content-md-end justify-content-between"> 
                <ul class="list-inline contact-info d-block d-md-none">
                  <li class="list-inline-item"><a href="#"><i class="fa fa-phone"></i></a></li>
                  <li class="list-inline-item"><a href="#"><i class="fa fa-envelope"></i></a></li>
                </ul>
                <div class="login">
                
                	<!-- Div que muestra el Iniciar Sesion si es que no tiene la sesion inciada -->
                	<a href="#" th:unless="${user.username != 'No_Session'}" data-toggle="modal" data-target="#login-modal" class="login-btn">
                		<i class="fa fa-sign-in"></i>
                			<span class="d-none d-md-inline-block">
                				Iniciar sesi&oacute;n
                			</span>
                	</a>&nbsp;	
                	
                	<!-- Si hay sesion muestra el nombre -->
                	<a th:if="${user.username != 'No_Session'}" href="#" data-toggle="modal" data-target="#login-modal" class="login-btn">
                		<i class="fa fa-user"></i>
                			<span class="d-none d-md-inline-block" th:text="${user.getFirstName()}">
                				
                			</span>
                	</a>&nbsp;	
                	
                	<!-- Si hay sesion muestra el nombre -->
                	<a th:unless="${user.username != 'No_Session'}" href="#" data-toggle="modal" data-target="#register-modal" class="login-btn">
                		<i class="fa fa-user"></i>
                			<span class="d-none d-md-inline-block">
                				Registrarte
                			</span>
                	</a>&nbsp;
                	
                	<!-- Cerrar Sesion -->
                	<a th:if="${user.username != 'No_Session'}" th:href="@{/logout}"  class="signup-btn">
                		<i class="fa fa-window-close"></i>
                			<span class="d-none d-md-inline-block">
                				Cerrar sesi&oacute;n
                			</span>
                	</a>
                	<!-- Cerrar Sesion -->
                	<!--<p th:unless="${user.getUserName() == 'No_Session'}" th:text="${user.getUserNombre()}"></p>-->
                	<!-- cierra leyenda Iniciar Sesion -->
                	
                	
                </div>
                <ul class="social-custom list-inline">
                  <li class="list-inline-item"><a target="_blank" href="https://api.whatsapp.com/send?phone=5215573764839&text=Hola%2c%20BeMedica&source=&data="><i class="fa fa-whatsapp"></i></a></li>
                  <li class="list-inline-item"><a href="#"><i class="fa fa-twitter"></i></a></li>
                  <li class="list-inline-item"><a href="#"><i class="fa fa-facebook"></i></a></li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
        <!-- Top bar end-->
        
        
        
        <!-- Login Modal-->
        <div id="login-modal" tabindex="-1" role="dialog" aria-labelledby="login-modalLabel" aria-hidden="true" class="modal fade">
            <div role="document" class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header" id="ContTituloLogin">
                        <h4 id="TituloLogin" class="modal-title">Iniciar Sesi&oacute;n</h4>
                        <button type="button" data-dismiss="modal" aria-label="Close" class="close"><span aria-hidden="true">×</span></button>
                    </div>
                    <div class="modal-body" >
                        <form th:action="@{/login}" method="post">
                            <div class="form-group">
                                <input name="username" type="text" placeholder="Correo electr&oacute;nico" class="form-control">
                            </div>
                            <div class="form-group">
                                <input name="password" type="password" placeholder="Contrase&ntilde;a" class="form-control">
                            </div>
                            	<h5 id="WarningLogin" style="color: red; display: none;">Para agendar una cita debes Iniciar Sesión</h5>
                            <p class="text-center">
                                <button type="submit" class="btn btn-template-outlined"><i class="fa fa-sign-in"></i> Iniciar sesi&oacute;n</button>
                            </p>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <!-- Login modal end-->
        
        
        
        <!-- Registro Modal-->
        <div id="register-modal" tabindex="-1" role="dialog" aria-labelledby="login-modalLabel" aria-hidden="true" class="modal fade">
            <div role="document" class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 id="login-modalLabel" class="modal-title">Registrarse</h4>
                        <button type="button" data-dismiss="modal" aria-label="Close" class="close"><span aria-hidden="true">×</span></button>
                    </div>
                    <div class="modal-body">
                        <form th:object="${userForm}" th:action="@{/signup}" method="post">
                            <div class="form-group">
                                <input th:field="${userForm.FirstName}" required type="text" placeholder="Nombre" class="form-control">
                            </div>
                            <div class="form-group">
                                <input th:field="${userForm.LastName}" required type="text" placeholder="Apellido Paterno" class="form-control">
                            </div>
                            <div class="form-group">
                                <input th:field="${userForm.apmat}" required type="text" placeholder="Apellido Materno" class="form-control">
                            </div>
                            <div class="form-group">
                                <input th:field="${userForm.username}" required type="text" placeholder="Usuario" class="form-control">
                            </div>
                            <div class="form-group">
                                <input th:field="${userForm.email}" required type="email" placeholder="Correo electr&oacute;nico" class="form-control">
                            </div>
                            <div class="form-group">
                                <input th:field="${userForm.password}" required type="password" placeholder="Contrase&ntilde;a" class="form-control">
                            </div>
                            <div class="form-group">
                                <input th:field="${userForm.confirmPassword}" required type="password" placeholder="Contrase&ntilde;a" class="form-control">
                            </div>
                            <p class="text-center">
                                <button class="btn btn-template-outlined"><i class="fa fa-sign-in"></i> Registrarse</button>
                            </p>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <!-- Registro modal end-->
        <!-- Navbar Start-->
        <header class="nav-holder make-sticky">
        	<input id="idpaciente" th:value="${user.getId()}" type="hidden">
        	<input id="emailpaciente" th:value="${user.getEmail()}" type="hidden">
        	<input id="idmed" value="0" type="hidden">
            <div id="navbar" role="navigation" class="navbar navbar-expand-lg">
                <div class="container">
                    <a th:href="@{/}" class="navbar-brand home"><img src="img/logo.png" alt="Universal logo" class="d-none d-md-inline-block"><img src="img/logo-small.png" alt="Universal logo" class="d-inline-block d-md-none" /><span class="sr-only">Universal - go to homepage</span></a>
                    <button type="button" data-toggle="collapse" data-target="#navigation" class="navbar-toggler btn-template-outlined"><span class="sr-only">Toggle navigation</span><i class="fa fa-align-justify"></i></button>
                    <div id="navigation" class="navbar-collapse collapse">
                        <ul class="nav navbar-nav ml-auto">
                            <li class="nav-item dropdown menu-large"><a href="#">Regresar a la pagina<b class="caret"></b></a></li>
                            <li class="nav-item dropdown menu-large active"><a th:href="@{/}">Comunidad BeM&eacute;dica<b class="caret"></b></a></li>
                        </ul>
                    </div>
                    <div id="search" class="collapse clearfix">
                        <form role="search" class="navbar-form">
                            <div class="input-group">
                                <input type="text" placeholder="Search" class="form-control"><span class="input-group-btn">
                    <button type="submit" class="btn btn-template-main"><i class="fa fa-search"></i></button></span>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </header>
        <!-- Navbar End-->
        <div id="heading-breadcrumbs">
            <div class="container">
                <div class="row d-flex align-items-center flex-wrap">
                    <div class="col-md-5">
                    	<p id="TitleEspecialidad">Selecciona la especialidad:</p>
                    	<p id="WarningEspecialidad" style="color: red">Selecciona una especialidad para realizar la búsqueda</p>
                        <div class="form-group">
                           <!--<input type="text" placeholder="Especialidad..." class="form-control" id="Especialidad">-->
                           <select class="form-control" id="Especialidad">
                           	<option value="None" selected>Seleccione su especialidad</option>
   							<option value="ALGOLOGÍA">ALGOLOGÍA</option>
   							<option value="ANATOMÍA PATOLÓGICA">ANATOMÍA PATOLÓGICA</option>
   							<option value="ANESTESIOLOGÍA">ANESTESIOLOGÍA</option>
   							<option value="ANESTESIOLOGÍA PARA LOS SERVICIOS RURALES DE LA SALUD">ANESTESIOLOGÍA PARA LOS SERVICIOS RURALES DE LA SALUD</option>
   							<option value="ANESTESIOLOGÍA PEDIÁTRICA">ANESTESIOLOGÍA PEDIÁTRICA</option>
   							<option value="ANGIOLOGÍA Y CIRUGÍA VASCULAR">ANGIOLOGÍA Y CIRUGÍA VASCULAR</option>
   							<option value="ANGIOLOGÍA, CIRUGÍA VASCULAR Y ENDOVASCULAR">ANGIOLOGÍA, CIRUGÍA VASCULAR Y ENDOVASCULAR</option>
   							<option value="ASMA">ASMA</option>
   							<option value="BIOLOGIA DE LA REPRODUCCION HUMANA">BIOLOGIA DE LA REPRODUCCION HUMANA</option>
   							<option value="BRONCOSCOPÍA INTERVENCIONISTA">BRONCOSCOPÍA INTERVENCIONISTA</option>
   							<option value="BRONCOSCOPÍA INTERVENCIONISTA PEDIÁTRICA">BRONCOSCOPÍA INTERVENCIONISTA PEDIÁTRICA</option>
   							<option value="CARDIOLOGÍA CLÍNICA">CARDIOLOGÍA CLÍNICA</option>
   							<option value="CARDIOLOGÍA INTERVENCIONISTA">CARDIOLOGÍA INTERVENCIONISTA</option>
   							<option value="CARDIOLOGÍA INTERVENCIONISTA EN CARDIOPATÍAS CONGÉNITAS">CARDIOLOGÍA INTERVENCIONISTA EN CARDIOPATÍAS CONGÉNITAS</option>
   							<option value="CARDIOLOGÍA PEDIÁTRICA">CARDIOLOGÍA PEDIÁTRICA</option>
   							<option value="CIRUGÍA BARIÁTRICA">CIRUGÍA BARIÁTRICA</option>
   							<option value="CIRUGÍA CARDIACA EN ADULTOS">CIRUGÍA CARDIACA EN ADULTOS</option>
   							<option value="CIRUGÍA CARDIACA EN PEDIATRÍA">CIRUGÍA CARDIACA EN PEDIATRÍA</option>
   							<option value="CIRUGÍA CARDIOTORÁCICA">CIRUGÍA CARDIOTORÁCICA</option>
   							<option value="CIRUGÍA DE TÓRAX PEDIÁTRICA NO CARDIACA">CIRUGÍA DE TÓRAX PEDIÁTRICA NO CARDIACA</option>
   							<option value="CIRUGÍA DE TRASPLANTES">CIRUGÍA DE TRASPLANTES</option>
							<option value="CIRUGÍA DEL APARATO DIGESTIVO">CIRUGÍA DEL APARATO DIGESTIVO</option>
   							<option value="CIRUGÍA GENERAL">CIRUGÍA GENERAL</option>
   							<option value="CIRUGÍA NEUROLÓGICA">CIRUGÍA NEUROLÓGICA</option>
   							<option value="CIRUGÍA ONCOLÓGICA">CIRUGÍA ONCOLÓGICA</option>
   							<option value="CIRUGÍA ONCOLÓGICA PEDIÁTRICA">CIRUGÍA ONCOLÓGICA PEDIÁTRICA</option>
   							<option value="CIRUGÍA ORAL MAXILOFACIAL">CIRUGÍA ORAL MAXILOFACIAL</option>
   							<option value="CIRUGÍA PARA LOS SERVICIOS RURALES DE LA SALUD">CIRUGÍA PARA LOS SERVICIOS RURALES DE LA SALUD</option>
   							<option value="CIRUGÍA PEDIÁTRICA">CIRUGÍA PEDIÁTRICA</option>
   							<option value="CIRUGÍA PLÁSTICA, ESTÉTICA Y RECONSTRUCTIVA">CIRUGÍA PLÁSTICA, ESTÉTICA Y RECONSTRUCTIVA</option>
   							<option value="CIRUGÍA TORÁCICA NO CARDIACA">CIRUGÍA TORÁCICA NO CARDIACA</option>
   							<option value="CITOGENÉTICA">CITOGENÉTICA</option>
   							<option value="COLOPROCTOLOGÍA">COLOPROCTOLOGÍA</option>
   							<option value="COMUNICACIÓN AUDIOLOGÍA, OTONEUROLOGÍA Y FONIATRÍA">COMUNICACIÓN AUDIOLOGÍA, OTONEUROLOGÍA Y FONIATRÍA</option>
						   <option value="CUIDADOS PALIATIVOS">CUIDADOS PALIATIVOS</option>
						   <option value="DERMATOLOGÍA">DERMATOLOGÍA</option>
						   <option value="DERMATOLOGÍA PEDIÁTRICA">DERMATOLOGÍA PEDIÁTRICA</option>
						   <option value="ECOCARDIOGRAFÍA ADULTOS">ECOCARDIOGRAFÍA ADULTOS</option>
						   <option value="ECOCARDIOGRAFÍA PEDIÁTRICA">ECOCARDIOGRAFÍA PEDIÁTRICA</option>
						   <option value="ELECTROFISIOLOGÍA">ELECTROFISIOLOGÍA</option>
						   <option value="ENDOCRINOLOGÍA">ENDOCRINOLOGÍA</option>
						   <option value="ENDOCRINOLOGÍA PEDIÁTRICA">ENDOCRINOLOGÍA PEDIÁTRICA</option>
						   <option value="ENDOSCOPÍA DEL APARATO DIGESTIVO">ENDOSCOPÍA DEL APARATO DIGESTIVO</option>
						   <option value="ENDOSCOPÍA TORÁCICA">ENDOSCOPÍA TORÁCICA</option>
						   <option value="EPIDEMIOLOGÍA">EPIDEMIOLOGÍA</option>
						   <option value="FISIOLOGÍA RESPIRATORIA">FISIOLOGÍA RESPIRATORIA</option>
						   <option value="FISIOLOGÍA RESPIRATORIA PEDIÁTRICA">FISIOLOGÍA RESPIRATORIA PEDIÁTRICA</option>
						   <option value="GASTROENTEROLOGÍA">GASTROENTEROLOGÍA</option>
						   <option value="GASTROENTEROLOGÍA PEDIÁTRICA">GASTROENTEROLOGÍA PEDIÁTRICA</option>
						   <option value="GENÉTICA MÉDICA">GENÉTICA MÉDICA</option>
						   <option value="GENÉTICA MOLECULAR">GENÉTICA MOLECULAR</option>
						   <option value="GERIATRÍA">GERIATRÍA</option>
						   <option value="GINECOLOGÍA ONCOLÓGICA">GINECOLOGÍA ONCOLÓGICA</option>
						   <option value="GINECOLOGÍA Y OBSTETRICIA">GINECOLOGÍA Y OBSTETRICIA</option>
						   <option value="HEMATOLOGÍA">HEMATOLOGÍA</option>
						   <option value="HEMATOLOGÍA PEDIÁTRICA">HEMATOLOGÍA PEDIÁTRICA</option>
						   <option value="IMAGEN DE LA MAMA">IMAGEN DE LA MAMA</option>
						   <option value="IMAGEN DEL SISTEMA MUSCULOESQUELÉTICO">IMAGEN DEL SISTEMA MUSCULOESQUELÉTICO</option>
						   <option value="INFECTOLOGÍA ADULTOS">INFECTOLOGÍA ADULTOS</option>
						   <option value="INFECTOLOGÍA PEDIÁTRICA">INFECTOLOGÍA PEDIÁTRICA</option>
						   <option value="INMUNOLOGÍA CLÍNICA Y ALERGIA">INMUNOLOGÍA CLÍNICA Y ALERGIA</option>
						   <option value="MEDICINA AEROESPACIAL">MEDICINA AEROESPACIAL</option>
						   <option value="MEDICINA CRÍTICA">MEDICINA CRÍTICA</option>
						   <option value="MEDICINA CRÍTICA EN OBSTETRICIA">MEDICINA CRÍTICA EN OBSTETRICIA</option>
						   <option value="MEDICINA DE REHABILITACIÓN">MEDICINA DE REHABILITACIÓN</option>
						   <option value="MEDICINA DE URGENCIAS">MEDICINA DE URGENCIAS</option>
						   <option value="MEDICINA DEL DEPORTE">MEDICINA DEL DEPORTE</option>
						   <option value="MEDICINA DEL ENFERMO PEDIÁTRICO EN ESTADO CRÍTICO">MEDICINA DEL ENFERMO PEDIÁTRICO EN ESTADO CRÍTICO</option>
						   <option value="MEDICINA DEL NIÑO Y DEL ADULTO PARA LOS SERVICIOS RURALES DE SALUD">MEDICINA DEL NIÑO Y DEL ADULTO PARA LOS SERVICIOS RURALES DE SALUD</option>
						   <option value="MEDICINA DEL SUEÑO">MEDICINA DEL SUEÑO</option>
						   <option value="MEDICINA DEL TRABAJO">MEDICINA DEL TRABAJO</option>
						   <option value="MEDICINA DEL TRABAJO Y AMBIENTAL">MEDICINA DEL TRABAJO Y AMBIENTAL</option>
						   <option value="MEDICINA FAMILIAR">MEDICINA FAMILIAR</option>
						   <option value="MEDICINA INTEGRADA">MEDICINA INTEGRADA</option>
						   <option value="MEDICINA INTERNA">MEDICINA INTERNA</option>
						   <option value="MEDICINA LEGAL Y FORENSE">MEDICINA LEGAL Y FORENSE</option>
						   <option value="MEDICINA MATERNO FETAL">MEDICINA MATERNO FETAL</option>
						   <option value="MEDICINA NUCLEAR">MEDICINA NUCLEAR</option>
						   <option value="MEDICINA NUCLEAR CARDIOLÓGICA">MEDICINA NUCLEAR CARDIOLÓGICA</option>
						   <option value="MEDICINA NUCLEAR ONCOLÓGICA, MOLECULAR Y TERAPÉUTICA">MEDICINA NUCLEAR ONCOLÓGICA, MOLECULAR Y TERAPÉUTICA</option>
						   <option value="MEDICINA PREVENTIVA">MEDICINA PREVENTIVA</option>
						   <option value="NEFROLOGÍA">NEFROLOGÍA</option>
						   <option value="NEFROLOGÍA PEDIÁTRICA">NEFROLOGÍA PEDIÁTRICA</option>
						   <option value="NEONATOLOGÍA">NEONATOLOGÍA</option>
						   <option value="NEUMOLOGÍA">NEUMOLOGÍA</option>
						   <option value="NEUMOLOGÍA PEDIÁTRICA">NEUMOLOGÍA PEDIÁTRICA</option>
						   <option value="NEURO-OTOLOGÍA">NEURO-OTOLOGÍA</option>
						   <option value="NEUROANESTESIOLOGÍA">NEUROANESTESIOLOGÍA</option>
						   <option value="NEUROCIRUGÍA PEDIÁTRICA">NEUROCIRUGÍA PEDIÁTRICA</option>
						   <option value="NEUROFISIOLOGÍA CLÍNICA">NEUROFISIOLOGÍA CLÍNICA</option>
						   <option value="NEUROLOGÍA ADULTOS">NEUROLOGÍA ADULTOS</option>
						   <option value="NEUROLOGÍA PEDIÁTRICA">NEUROLOGÍA PEDIÁTRICA</option>
						   <option value="NEUROPATOLOGÍA">NEUROPATOLOGÍA</option>
						   <option value="NEURORRADIOLOGÍA">NEURORRADIOLOGÍA</option>
						   <option value="OFTALMOLOGÍA">OFTALMOLOGÍA</option>
						   <option value="ONCOLOGÍA MÉDICA">ONCOLOGÍA MÉDICA</option>
						   <option value="ONCOLOGÍA PEDIÁTRICA">ONCOLOGÍA PEDIÁTRICA</option>
						   <option value="ORTOPEDIA Y TRAUMATOLOGÍA">ORTOPEDIA Y TRAUMATOLOGÍA</option>
						   <option value="OTORRINOLARINGOLOGÍA PEDIÁTRICA">OTORRINOLARINGOLOGÍA PEDIÁTRICA</option>
						   <option value="OTORRINOLARINGOLOGÍA Y CIRUGÍA DE CABEZA Y CUELLO">OTORRINOLARINGOLOGÍA Y CIRUGÍA DE CABEZA Y CUELLO</option>
						   <option value="PATOLOGÍA CLÍNICA">PATOLOGÍA CLÍNICA</option>
						   <option value="PATOLOGÍA PEDIÁTRICA">PATOLOGÍA PEDIÁTRICA</option>
						   <option value="PEDIATRÍA">PEDIATRÍA</option>
						   <option value="PSIQUIATRÍA">PSIQUIATRÍA</option>
						   <option value="PSIQUIATRÍA INFANTIL Y DE LA ADOLESCENCIA">PSIQUIATRÍA INFANTIL Y DE LA ADOLESCENCIA</option>
						   <option value="RADIO ONCOLOGÍA">RADIO ONCOLOGÍA</option>
						   <option value="RADIOLOGÍA E IMAGEN">RADIOLOGÍA E IMAGEN</option>
						   <option value="RADIOLOGÍA PEDIÁTRICA">RADIOLOGÍA PEDIÁTRICA</option>
						   <option value="RADIOLOGÍA VASCULAR E INTERVENCIONISTA">RADIOLOGÍA VASCULAR E INTERVENCIONISTA</option>
						   <option value="REHABILITACIÓN CARDÍACA">REHABILITACIÓN CARDÍACA</option>
						   <option value="REHABILITACIÓN CARDIACA Y PREVENCIÓN SECUNDARIA">REHABILITACIÓN CARDIACA Y PREVENCIÓN SECUNDARIA</option>
						   <option value="REHABILITACIÓN PULMONAR">REHABILITACIÓN PULMONAR</option>
						   <option value="REHABILITACIÓN PULMONAR PEDIÁTRICA">REHABILITACIÓN PULMONAR PEDIÁTRICA</option>
						   <option value="REUMATOLOGÍA">REUMATOLOGÍA</option>
						   <option value="REUMATOLOGÍA PEDIÁTRICA">REUMATOLOGÍA PEDIÁTRICA</option>
						   <option value="SALUD PÚBLICA">SALUD PÚBLICA</option>
						   <option value="TERAPIA ENDOVASCULAR NEUROLÓGICA">TERAPIA ENDOVASCULAR NEUROLÓGICA</option>
						   <option value="TERAPIA ENDOVASCULAR NEUROLÓGICA">TERAPIA ENDOVASCULAR NEUROLÓGICA</option>
						   <option value="TRANSPLANTE RENAL">TRANSPLANTE RENAL</option>
						   <option value="URGENCIAS PEDIÁTRICAS">URGENCIAS PEDIÁTRICAS</option>
						   <option value="UROLOGÍA">UROLOGÍA</option>
						   <option value="UROLOGÍA GINECOLÓGICA">UROLOGÍA GINECOLÓGICA</option>
                           </select>
                        </div>
                    </div>
                    <div class="col-md-4">
                    	<p id="TitleEstado">Selecciona un Estado(opcional):</p>
                    	<p id="WarningEstado" style="color: red">Selecciona un estado para realizar la búsqueda</p>
                        <div class="form-group">
                           		<select class="form-control" id="estadoIngresado">
                           			<option value="Estado">Estado</option>
  									<option value="Aguascalientes">Aguascalientes</option>
  									<option value="Baja California">Baja California</option>
  									<option value="Baja California Sur">Baja California Sur</option>
  									<option value="Campeche">Campeche</option>
  									<option value="Chiapas">Chiapas</option>
  									<option value="Chihuahua">Chihuahua</option>
  									<option value="Mexico City">Ciudad de México</option>
  									<option value="Coahuila">Coahuila de Zaragoza</option>
  									<option value="Colima">Colima</option>
  									<option value="Durango">Durango</option>
  									<option value="México">Estado de México</option>
  									<option value="Guanajuato">Guanajuato</option>
  									<option value="Guerrero">Guerrero</option>
  									<option value="Hidalgo">Estado de Hidalgo</option>
  									<option value="Jalisco">Jalisco</option>
  									<option value="Michoacán">Michoacán de Ocampo</option>
  									<option value="Morelos">Morelos</option>
  									<option value="Nayarit">Nayarit</option>
  									<option value="Nuevo León">Nuevo León</option>
  									<option value="Oaxaca">Oaxaca</option>
  									<option value="Puebla">Puebla</option>
  									<option value="Querétaro">Querétaro</option>
  									<option value="Quintana Roo">Quintana Roo</option>
  									<option value="San Luis Potosí">San Luis Potosí</option>
  									<option value="Sinaloa">Sinaloa</option>
  									<option value="Sonora">Sonora</option>
  									<option value="Tabasco">Tabasco</option>
  									<option value="Tamaulipas">Tamaulipas</option>
  									<option value="Tlaxcala">Tlaxcala</option>
  									<option value="Veracruz">Veracruz</option>
  									<option value="Yucatán">Yucatán</option>
  									<option value="Zacatecas">Zacatecas</option>
							</select>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                        <p> </p>
                           <button type="button" class="btn btn-primary btn-md" style="margin-top: 10%;" onclick="getLocation()">Buscar <i class="fa fa-search"></i></a></button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <section class="text-center" style="width: 100% !important;">
        
        <!-- Contenido de Append -->
        <p id="mensajeAjax"></p>
        
        
        <!-- Fichas de Medicos -->
        <div class="Quitar">
        <div class="row">
       		<img src="img/fondo.png">
        </div>
        </div>
        
        <div>
        	<div id="loader" class="loader"></div>
        	<div class="row" id="seccionMedicos">
        		
        	</div>
        </div>
        <!-- Fichas de Medicos -->
        
        
        </section>
        
        
        <!-- Modal de Calendario -->
        <div class="container">
        <div th:include="modal_calendario.html">
        
        </div>
        </div>
        <!-- Modal de Calendario -->
        
        <!-- Modal de Info-->
		<div class="modal fade" id="informacion" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
		  <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
		    <div class="modal-content">
		      <div class="modal-header">
		        <h5 class="modal-title" id="exampleModalLongTitle"><p id="ContNombreDoctor"><p id="NombreDoctor"></p></p></h5>
		        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
		          <span aria-hidden="true">&times;</span>
		        </button>
		      </div>
		      <div class="modal-body">
		        <table class="table table-borderless">
  					<thead>
    					<tr>
      						<th scope="col">Especialidad</th>
      						<th scope="col">Tel&eacute;fono</th>
      						<th scope="col">Primera consulta</th>
      						<th scope="col">Control Consulta</th>
      						<th scope="col">Domicilio Consulta</th>
    					</tr>
  					</thead>
  					<tbody>
    					<tr>
      						<td id="ContainerEspecialidad"></td>
      						<td id="ContainerTelefono"></td>
      						<td id="ContainerPrimerConsulta"></td>
      						<td id="ContainerControlConsulta"></td>
      						<td id="ContainerDomicilioConsulta"></td>
    					</tr>
  					</tbody>
				</table>
  					<div id="PegarDireccion">
					
					</div>
		      </div>
		    </div>
		  </div>
		</div>
		<!-- Modal de Info-->
		
		
        <!-- FOOTER -->
        <footer class="main-footer1">
            <div class="copyrights">
                <div class="container">
                    <div class="row">
                        <div class="col-lg-4 text-center-md">
                            <p>D.R. &copy; Copyright 2020. BeM&eacute;dica. S.A. de C.V.</p>
                        </div>
                        <div class="col-lg-8 text-right text-center-md">
                            <p>Template design by <a href="https://bootstrapious.com/p/big-bootstrap-tutorial">Bootstrapious </a>& <a href="https://fity.cz/ostrava">Fity</a></p>
                            <!-- Please do not remove the backlink to us unless you purchase the Attribution-free License at https://bootstrapious.com/donate. Thank you. -->
                        </div>
                    </div>
                </div>
            </div>
        </footer>
    </div>
    
    <div class="modal fade" id="CorreoEnviadoModal" tabindex="-1" role="dialog">
		<div class="modal-dialog" role="document">
		    <div class="modal-content">
		      <div class="modal-header">
		        <h5 class="modal-title">Cita Agendada</h5>
			        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
			          <span aria-hidden="true">&times;</span>
			        </button>
		      </div>
		      <div class="modal-body">
		        <p>Se ha enviado la información de la cita a tu correo.</p>
		      </div>
		      <div class="modal-footer">
		        <button type="button" class="btn btn-secondary" data-dismiss="modal">Aceptar</button>
	      	  </div>
	    </div>
	  </div>
	</div>
    <!-- Javascript files-->

    <script src="https://code.jquery.com/jquery-2.2.0.min.js" type="text/javascript"></script>
    <script src="css/slick/slick.js" type="text/javascript" charset="utf-8"></script>
    <script src="vendor/popper.js/umd/popper.min.js">
    </script>
    <script src="vendor/bootstrap/js/bootstrap.min.js"></script>
    <script src="vendor/jquery.cookie/jquery.cookie.js">
    </script>
    <script src="vendor/waypoints/lib/jquery.waypoints.min.js">
    </script>
    <script src="vendor/jquery.counterup/jquery.counterup.min.js">
    </script>
    <script src="vendor/owl.carousel/owl.carousel.min.js"></script>
    <script src="vendor/owl.carousel2.thumbs/owl.carousel2.thumbs.min.js"></script>
    <script src="js/jquery.parallax-1.1.3.js"></script>
    <script src="vendor/bootstrap-select/js/bootstrap-select.min.js"></script>
    <script src="vendor/jquery.scrollto/jquery.scrollTo.min.js"></script>
    <script src="js/front.js"></script>
    <script src="js/slidedoc.js" type="text/javascript"></script>
    <script src="js/Location.js" type="text/javascript"></script>
    
    <!-- Calendario -->
    <script src="plugins/moment/moment.min.js"></script>
	<script src="plugins/fullcalendar/main.min.js"></script>
	<script src="plugins/fullcalendar-daygrid/main.min.js"></script>
	<script src="plugins/fullcalendar-timegrid/main.min.js"></script>
	<script src="plugins/fullcalendar-interaction/main.min.js"></script>
	<script src="plugins/fullcalendar/locales-all.min.js"></script>
	<script src="plugins/fullcalendar-bootstrap/main.min.js"></script>
    <!-- Calendario -->
    <script>
    	var VueltasAppend = 1;
    	var events = [];
    	$('#botonCerrarCalendario').hide();
    	$('#WarningEstado').hide();
    	$('#WarningEspecialidad').hide();
    	$('#loader').hide();
    	
    	//Calendario original
	    var Calendar = FullCalendar.Calendar;
        var calendarEl = document.getElementById('calendar');
        var calendar;
      	//Fin
    	
    	
    	$(function () {
    	    var dialog, form,
    	    
         	tips = $( ".validateTips" ); 
        
        function validateDateRange(start, end) {
        	console.log("inicio:"+start+"fin:"+end);
        	if(!start.isValid()) {
        		alert("Start date is invalid");
        		return false; 
        	}
        	
        	if(!end.isValid()) {
        		alert("End date is invalid");
        		return false; 
        	}
        	
        	if(start.isAfter(end)) {
    	 		alert("End date must be after start date");	
    	 		return false; 
    	 	}
        	
        	if(start.isSame(end)) {
        		alert("End date must be after start date");
        		return false;
        	}
        	return true;
        }
        
    	//Funcion para remover Evento
       	function removeEvent() {  
        	var eventData;
    		if (uid.value) {
    			eventData = uid.value;
    			$('#agendarCita').modal('hide');
        		$.ajax({
        	        type: "DELETE",
        	        url: "/event",
        	        data: "id="+eventData,
        	        success: (data) => {
        	        	calendar.refetchEvents()
        	        	console.log("id="+eventData);
        	        },
        	        error: (e) => {
        	            $("#error").text(e.responseText);
        	        }
        	      });
    			
    		}
    	    return true;
        }
    	 
    	
    	//Funcion para editar evento preparacion
        function editEvent(info) 
    	{
        	var eventStart = moment(info.event.start).format("YYYY-MM-DDTHH:mm:ss"); //moment(event.start);
     		var eventEnd = moment(info.event.end).format("YYYY-MM-DDTHH:mm:ss");
     			
           	newtitle.value = info.event.title;
    	    description.value = info.event.extendedProps.description; 
    	    startdateandtime.value = eventStart;			
    	    enddateandtime.value = eventEnd;
    	    uid.value = info.event.id;
    	    $('#agendarCita').modal('toggle');    
        }	
        
    	//Funcion para editar evento
        function saveEvent() 
        {
        	var valid = true;
    	 	var eventStart = moment(startdateandtime.value);
     		var eventEnd = moment(enddateandtime.value);
     		var idpaciente = $('#idpaciente').val();
     		var idmed = $('#idmed').val();
     		valid = valid && newtitle.value;
    	 	valid = valid && validateDateRange(eventStart, eventEnd);
    	   
    		if ( valid ) {
    	    	var eventData;
    			if (newtitle.value) {
    				eventData = {
    					id: uid.value,
    					title: newtitle.value,
    					start: startdateandtime.value,
    					end:  enddateandtime.value, 
    					description: description.value,
    					color: 'red',
    					status: 0,
    					idmedico: idmed,
    					idpaciente: idpaciente,
    					
    				};
    			}	
    		
    			calendar.unselect();
    		
    			$('#agendarCita').modal('hide');
    			//Ajax para parchear eventp
        		$.ajax({
        	        type: "PATCH",
        	        url: "/event",
    			    data: JSON.stringify(eventData),
    			    contentType: "application/json; charset=utf-8",
    			    dataType: "json",
        	        success: (data) => {
        	        	EnviarMail(eventData);
        	        	calendar.refetchEvents()
        	        	console.log(JSON.stringify(eventData));
        	        	newtitle.value = null;
    			    	description.value = null;
    			    	$('#agendarCita').modal('hide');
    			    	$('#VerAgendarCita').modal('hide');
        	        },
        	        error: (e) => {
        	        	console.log("error");
        	        }
        	      });
        	}
    	 	return valid;
        }
    	
    	//Funcion para mover evento
        function moveEvent(info) 
    	{
        	var eventStart = moment(info.event.start).format("YYYY-MM-DDTHH:mm:ss"); //moment(event.start);
    		var eventEnd = moment(info.event.end).format("YYYY-MM-DDTHH:mm:ss");
        	var valid = true;
        	valid = valid && info.event.title;
        	var idpaciente = $('#idpaciente').val();
        	var idmed = $('#idmed').val();
        	
    		if(valid) 
    		{
    			console.log("entra");
    	    	var eventData;
    			if (info.event.title) 
    				{
    					eventData = {
    						id: info.event.id,
    						title: info.event.title,
    						start: eventStart,
    						end:  eventEnd, 
    						description: description.value,
    						color: 'blue',
        					idmed: idmed,
        					idpaciente: idpaciente,
        				};
	    			}
    			
    			calendar.unselect();
    			$('#agendarCita').modal('hide');
    			console.log(JSON.stringify(eventData));
    			
    			//Funcion ajax para editar un evento de fecha
        		$.ajax({
        	        type: "PATCH",
        	        url: "/event",
    			    data: JSON.stringify(eventData),
    			    contentType: "application/json; charset=utf-8",
    			    dataType: "json",
        	        success: (data) => {
        	        	EnviarMail(eventData);
        	        	calendar.refetchEvents()
        	        	console.log(JSON.stringify(eventData));
        	        	newtitle.value = "";
    			    	description.value = "";
    			    	EnviarMail(eventData);
        	        },
        	        error: (e) => {
        	        	console.log("error");
        	        }
        	      });
        	}
    	 	return valid;
        }
    	
    	
    	
    	
        //Funcion para añadir un evento
        function addEvent(start, end) 
        {
          	var valid = true;
     		var eventStart = moment(startdateandtime.value);
     		var eventEnd = moment(enddateandtime.value);
     		var idpaciente = $('#idpaciente').val();
     		var idmed = $('#idmed').val();
     		var email = $('#emailpaciente').val();
     		
    		valid = valid && newtitle.value;
    	 	valid = valid && startdateandtime.value;
    	 	valid = valid && validateDateRange(eventStart, eventEnd);
    	 	    
    		if(valid) 
    		{
    	    	var eventData;
    			if (newtitle.value) 
    				{
    					eventData = {
	    					title: newtitle.value,
    						description: description.value,
    						start: startdateandtime.value,
    						end: enddateandtime.value, 
    						color: color.value,
    						idpaciente: idpaciente,
    						idmedico: idmed,
    						email: email
        					};
    				}
    			
    			calendar.unselect();
    			$('#agendarCita').modal('hide');
    			
    			//Funcio ajax que guarda
    			 $.ajax({
    			    type: "POST",
    			    url: "/event",
    			    data: JSON.stringify(eventData),
    			    contentType: "application/json; charset=utf-8",
    			    dataType: "json",
    			    success: function(data){
    			    	//calendar.addEvent(eventData)
    			    	console.log("Worked " + JSON.stringify(eventData));
    			    	$('.fc-event').remove();
    			    	calendar.refetchEvents();
    			    	newtitle.value = null;
    			    	description.value = null;
    			    },
    			    failure: function(errMsg) {
    			        alert(errMsg);
    			    }
    			});
          }
          return valid;
        }
        
        function Unselectar()
        {
        	calendar.unselect();
        }
        
        //Funciones que avisan cuando se llama una funcion
        $("#submit-modal").click((e) => {
        	
        	idpaciente = $('#idpaciente').val();
        	if(!idpaciente)
        	{
        		console.log("logeat");
        	}
        	else
        	{
	        	e.preventDefault();
	        	if($("#submit-modal"). val()=='1')
	        	{
	        		addEvent();
	        	}
	        	else
	        	{
	        		saveEvent();
	        	}	
        	}
        });
        $("#nueva-cita").click((e) => {
        	
        	idpaciente = $('#idpaciente').val();
        	if(!idpaciente)
        	{
        		console.log("logeat");
        	}
        	else
        	{
        		console.log("siento no fncar :,v");
            	e.preventDefault();
            	$('#delete-modal').hide();
            	$('#submit-modal').text("Agendar");
            	$('#submit-modal').val("1");	
        	}
        });
        
        $("#delete-modal").click((e) => {
        	console.log("hola");
        	e.preventDefault();
        	
        	removeEvent();
        }); 
        
        
        ObtenerCitas = function(id) 
        {	
        	var interval = "00:30:00";
        	var starter;
        	var finaler;
        	
        	$.ajax({
			    type: "GET",
			    url: "/findCitas",
			    data: "id="+id,
			    success: function(data)
			    {
			    	var obj = JSON.parse(data);
			    	console.log("jojo");
			    	console.log(obj);
			    	console.log("jojo");
			    	if(obj[0] != null)
			    	{
				    	var inicio = obj[0].start;
				    	var fin = obj[0].end;
				    	var tiempo = parseInt(fin.substring(14, 16)) - parseInt(inicio.substring(14, 16));
				    	var starterNum = (obj.length - 2);
 				    	var finalerNum = (obj.length - 1);
				    	console.log(obj[starterNum]);
				    	console.log(obj[finalerNum]);
				    	starter = obj[starterNum];
				    	finaler = obj[finalerNum];
			    	}
			    	else
			    	{
			    		starter = "08:00:00";
				    	finaler = "20:00:00";
			    		ObtenerIntervalos(id, "00:30:00", "08:00:00", "20:00:00");
			    	}

			    	switch (tiempo) 
			    	{
			    	  case 15:
			    	    console.log("Fue 15");
			    	    interval =  "00:15:00";
			    	    break;
			    	  case 30:
			    		console.log("Fue 30");
			    		interval = "00:30:00";
			    	    break;
			    	  case 45:
			    		console.log("Fue 45");
			    		interval = "00:45:00";
			    	    break;
			    	  case 0:
			    		console.log("Fue 60");
			    		interval = "00:60:00";
				    	break;
			    	  default:
			    		console.log("Fue no se");
			    	  	interval = "00:60:00";
			    	    break;
			    	}
			    	console.log(starter, finaler);
			    	ObtenerIntervalos(id, interval, starter, finaler);
			    	
			    },
			    failure: function(errMsg) {
			        alert(errMsg);
			    }
			});        	
        }
        
        //Funcion para pintar en base a un medico
        ObtenerIntervalos = function(id, interval, starter, finaler) {
        	
        	$('#idmed').val("");
        	$('#idmed').val(id);


        	//Se pinta la info del medico en los p y b
        	$.ajax({
    			    type: "GET",
    			    url: "/getMedico",
    			    data: "id="+id,
    			    success: function(data)
    			    {
    			    	console.log(data);
    			    	$('#NombreMedico').remove();
    			    	$('#ContenedorNombreMedico').append("<b id='NombreMedico'>" + data[0] + " " + data[1] + " " + data[2] +"</b>");
    			    	
    			    	$('#CedulaMedico').remove();
    			    	$('#ContenedorCedulaMedico').append("<b id='CedulaMedico'>" + data[3] +"</b>");
    			    	
    			    	$('#EspecialidadMedico').remove();
    			    	$('#ContenedorEspecialidadMedico').append("<b id='EspecialidadMedico'>" + data[4] +"</b>");
    			    	
    			    	$('#DireccionMedico').remove();
    			    	$('#ContenedorDireccionMedico').append("<b id='DireccionMedico'>" + data[5] +"</b>");
    			    	
    			    	$('#CostoMedico').remove();
    			    	$('#ContenedorCostoMedico').append("<b id='CostoMedico'>" + data[6] +"</b>");	
    			    	
    			    },
    			    failure: function(errMsg) {
    			        alert(errMsg);
    			    }
    			});
        	
        	
        	
        	//Se hace null todo
        	calendar = null;
        	Calendar = null
        	Calendar = FullCalendar.Calendar;
        	$('#calendar').remove();
        	$('#ContenedorNuevo').append("<div id='calendar'></div>");
        	calendarEl = document.getElementById('calendar');
        	
        	//Pintada de Calendario
        	calendar = new Calendar(calendarEl, {
            locale:"es-us",
            plugins: [ 'bootstrap', 'interaction', 'timeGridWeek', 'timeGrid','list'],
            header    : {
              left  : 'prev',
              center: 'title',
              right : 'next'
            },
            allDaySlot:false,
      		defaultDate: moment().format("YYYY-MM-DD"),
      		editable: false,
      		slotLabelInterval: interval,
      		slotDuration: interval,
      		viewSubSlotLabel : true,
      		minTime: starter,
      		maxTime: finaler,
      		contentHeight: 'auto',
      		eventDrop: function(info) {
      			    if (!confirm("¿Seguro que quieres realizar estos cambios?")) {
      			      	info.revert();
      			    }
      			    else{
      			    	moveEvent(info);
      			    }
      			  },
      	   eventResize: function(info) {
      		    if (!confirm("¿Seguro que quieres realizar estos cambios?")) {
      		      	info.revert();
      		    }
      		    else{
      		    	moveEvent(info);
      		    }
      		  },
      		eventLimit: true, // allow "more" link when too many events
      		events: {
      			
      			url: '/findCitas',
      		    method: 'GET',
      		    extraParams: {
      		      id: id 
      		    },
      		    success: function(data) {
      		    	
      		    	//
      		    },
      		    failure: function() {
      		      alert('Este médico no tiene citas disponibles');
      		    }
      	    },
      		selectable: false,
      		selectHelper: false,
      		selectMirror: false,
      		timeFormat: 'h(:mm)',
      		select: function(arg) 
      		{	
      			idpaciente = $('#idpaciente').val();
            	if(!idpaciente)
            	{
            		$('#VerAgendarCita').modal('toggle');
            		$('#WarningLogin').show();
            		$('#login-modal').modal('toggle');	
            	}
            	else
            	{
            		console.log("inicio:"+ moment(arg.start).format("YYYY-MM-DDTHH:mm:ss")+"final:"+moment(arg.end).format("YYYY-MM-DDTHH:mm:ss"));
          			startdateandtime.value = moment(arg.start).format("YYYY-MM-DDTHH:mm:ss");
          			enddateandtime.value = moment(arg.end).format("YYYY-MM-DDTHH:mm:ss");
          			
            		$('#submit-modal').val("1");
          			$('#submit-modal').text("Agendar");
          			$('#delete-modal').hide();
      				$('#agendarCita').modal('toggle');
            	}
      		},
      		eventClick: function(info) {
      		
      			idpaciente = $('#idpaciente').val();
            	if(!idpaciente)
            	{
            		$('#VerAgendarCita').modal('toggle');
            		$('#WarningLogin').show();
            		$('#login-modal').modal('toggle');	
            	}
            	else
            	{
	      			info.jsEvent.preventDefault(); 
	      			$('#delete-modal').show();
	      			$('#submit-modal').text("Agendar");
	      			$('#submit-modal').val("0");
	      			editEvent(info);
            	}
       	    }	
          });
        	
        	calendar.render();
        	

         
         
         
         
         setTimeout(function(){
       	 	console.log("esperando");
       	 	console.log(window.innerHeight);
       	 	calendar.refetchEvents();
       	  	//$('#html').css('box-sizing', 'content-box');
       	  	//$('#ContenedorNuevo').style.resize = "initial";
       	  	//window.open($(this).attr('href'),'title', 'width=800, height=700');
       	  	//$( ".fc-prev-button fc-button fc-button-primary" ).trigger( "click" );
       	  	document.querySelector('.fc-prev-button').click();
       	 	document.querySelector('.fc-next-button').click();
       	  	
 		}, 1000);
         
         
	    //Calendario Original
	    
	    
        //Coso de los pixeles
	    
       	
        };//Cierra la funcion CallCitas
        
        
        EnviarMail = function(cita) 
        {
        	console.log(JSON.stringify(cita));
        	$('#loader').show();
        	$('#seccionMedicos').hide();
        	
        	//realiza el envio
        	//Funcio ajax que guarda
			 $.ajax({
			    type: "POST",
			    url: "/EnvioMail",
			    data: JSON.stringify(cita),
			    contentType: "application/json; charset=utf-8",
			    dataType: "json",
			    success: function(data){
			    	//calendar.addEvent(eventData)
			    	console.log("Worked " + data);
			    	$('#loader').hide();
			    	$('#CorreoEnviadoModal').modal('toggle');
			    	$('#seccionMedicos').show();
			    },
			    failure: function(errMsg) {
			        alert(errMsg);
			    }
			});
        	
        }
       
      })
      
    
    </script>
</body>

</html>
